syntax = "proto3";

package mws.rng;

import "data.proto";
import "google/protobuf/wrappers.proto";

message Msg {
  oneof msg_type {
    StoreGet storeGet = 1;
    StorePut storePut = 2;
    StoreDelete storeDelete = 3;
    BucketPut bucketPut = 4;
    BucketGet bucketGet = 5;
    GetResp getResp = 6;
    PutSavingEntity putSavingEntity = 7;
    GetSavingEntity getSavingEntity = 8;
    BucketKeys bucketKeys = 9;
    GetBucketResp getBucketResp = 10;
    SavingEntity savingEntity = 11;
    ChangeState changeState = 12;
    Saved saved = 13;
  }
}

message StoreGet {
  bytes key = 1;
}

message StorePut {
  Data data = 1;
}

message StoreDelete {
  bytes key = 1;
}

message BucketPut {
  repeated Data data = 1;
}

message BucketGet { 
  int32 b = 1;
}

message GetResp {
  repeated Data d = 1;
}

message PutSavingEntity {
  bytes k = 1;
  bytes v = 2;
  bytes prev = 3;
}

message GetSavingEntity {
  bytes k = 1;
}

message BucketKeys {
  int32 b = 1;
}

message GetBucketResp {
  int32 b = 1;
  repeated Data l = 2;
}

message SavingEntity {
  bytes k = 1;
  bytes v = 2;
  bytes nextKey = 3;
}

message ChangeState {
  int32 quorumState = 1;
}

message GetBucketVc { 
  int32 b = 1;
}

message BucketVc {
  google.protobuf.BytesValue vc = 1;
}

message GetBucketIfNew { 
  int32 b = 1;
  google.protobuf.BytesValue vc = 2;
}

message NoChanges {
  int32 b = 1;
}

message ReplFailed {
  repeated string down = 1;
}

message Saved {
}
